---
const { cities = [], categories = [] } = Astro.props;

const url = new URL(Astro.request.url);

const selectedCity = url.searchParams.get("city") || "";
const selectedCategory = url.searchParams.get("category") || "";
const selectedRating = url.searchParams.get("rating") || "";
---

<div class="mb-10 rounded-3xl border border-[var(--color-light-taupe)] bg-white p-6 shadow-[var(--shadow-sm)]">
  <form method="GET" class="grid gap-4 md:grid-cols-4 items-end">

    <!-- City Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[var(--color-medium-gray)]">Stadt</label>
      <select name="city" class="rounded-xl border border-[var(--color-light-taupe)] bg-[var(--color-warm-cream)] px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-[var(--color-gentle-gold)]">
        <option value="">Alle Städte</option>
        {cities.map(city => (
          <option value={city.slug} selected={city.slug === selectedCity}>
            {city.name}
          </option>
        ))}
      </select>
    </div>

    <!-- Category Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[var(--color-medium-gray)]">Kategorie</label>
      <select name="category" class="rounded-xl border border-[var(--color-light-taupe)] bg-[var(--color-warm-cream)] px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-[var(--color-gentle-gold)]">
        <option value="">Alle Kategorien</option>
        {categories.map(cat => (
          <option value={cat.slug} selected={cat.slug === selectedCategory}>
            {cat.name}
          </option>
        ))}
      </select>
    </div>

    <!-- Rating Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[var(--color-medium-gray)]">Mindestbewertung</label>
      <select name="rating" class="rounded-xl border border-[var(--color-light-taupe)] bg-[var(--color-warm-cream)] px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-[var(--color-gentle-gold)]">
        <option value="">Beliebige Bewertung</option>
        <option value="4" selected={selectedRating === "4"}>4★ und höher</option>
        <option value="3" selected={selectedRating === "3"}>3★ und höher</option>
      </select>
    </div>

    <!-- Buttons -->
    <div class="flex gap-2">
      <button
        type="submit"
        class="w-full rounded-xl bg-[var(--color-gentle-gold)] px-4 py-2.5 text-white shadow-[var(--shadow-sm)] transition duration-300 hover:brightness-95 hover:scale-[1.01]"
      >
        Anwenden
      </button>

      <a
        href={Astro.url.pathname}
        class="w-full rounded-xl border border-[var(--color-light-taupe)] bg-[var(--color-warm-cream)] px-4 py-2.5 text-center text-[var(--color-deep-slate)] transition-colors hover:border-[var(--color-gentle-gold)] hover:text-[var(--color-deep-slate)]"
      >
        Zurücksetzen
      </a>
    </div>

  </form>
</div>

