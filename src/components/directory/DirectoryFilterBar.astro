---
const { cities = [], categories = [] } = Astro.props;

const url = new URL(Astro.request.url);

const selectedCity = url.searchParams.get("city") || "";
const selectedCategory = url.searchParams.get("category") || "";
const selectedRating = url.searchParams.get("rating") || "";
---

<div class="mb-10 rounded-3xl border border-[#EFE7E2] bg-[#F3ECE8]/45 p-6 shadow-sm">
  <form method="GET" class="grid gap-4 md:grid-cols-4 items-end">

    <!-- City Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[#8C8587]">Stadt</label>
      <select name="city" class="rounded-xl border border-[#EFE7E2] bg-[#FBF6F2] px-3 py-2.5">
        <option value="">Alle Städte</option>
        {cities.map(city => (
          <option value={city.slug} selected={city.slug === selectedCity}>
            {city.name}
          </option>
        ))}
      </select>
    </div>

    <!-- Category Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[#8C8587]">Kategorie</label>
      <select name="category" class="rounded-xl border border-[#EFE7E2] bg-[#FBF6F2] px-3 py-2.5">
        <option value="">Alle Kategorien</option>
        {categories.map(cat => (
          <option value={cat.slug} selected={cat.slug === selectedCategory}>
            {cat.name}
          </option>
        ))}
      </select>
    </div>

    <!-- Rating Filter -->
    <div class="flex flex-col">
      <label class="mb-2 text-sm font-medium uppercase tracking-[0.16em] text-[#8C8587]">Mindestbewertung</label>
      <select name="rating" class="rounded-xl border border-[#EFE7E2] bg-[#FBF6F2] px-3 py-2.5">
        <option value="">Beliebige Bewertung</option>
        <option value="4" selected={selectedRating === "4"}>4★ und höher</option>
        <option value="3" selected={selectedRating === "3"}>3★ und höher</option>
      </select>
    </div>

    <!-- Buttons -->
    <div class="flex gap-2">
      <button
        type="submit"
        class="w-full rounded-xl bg-[#D8A7B1] px-4 py-2.5 text-[#FBF6F2] hover:bg-[#9CAF9A]"
      >
        Anwenden
      </button>

      <a
        href={Astro.url.pathname}
        class="w-full rounded-xl border border-[#D8A7B1]/60 px-4 py-2.5 text-center text-[#8E4A5A] hover:bg-[#FBF6F2]"
      >
        Zurücksetzen
      </a>
    </div>

  </form>
</div>

