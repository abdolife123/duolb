---
import SalonImage from "../directory/SalonImage.astro";

type FeaturedSalon = {
  salon_name: string | null;
  slug: string;
  cover_image: string | null;
  rating_value: number | null;
  rating_count: number | null;
  full_address: string | null;
  category_name?: string | null;
  city_name?: string | null;
};

interface Props {
  salons: FeaturedSalon[];
}

const { salons } = Astro.props;
---

<section class="mt-16" aria-labelledby="home-featured">
  <div class="flex flex-col gap-3 md:flex-row md:items-end md:justify-between">
    <div>
      <h2 id="home-featured" class="text-2xl md:text-3xl font-serif text-slate-900">
        Empfohlene Salons
      </h2>
      <p class="mt-2 text-sm text-slate-600 max-w-2xl">
        Eine kuratierte Auswahl anhand von Bewertungen und Beliebtheit. Klicke f&uuml;r Details, Adresse und Kontakt.
      </p>
    </div>
    <a
      href="/directory"
      class="text-sm font-semibold text-[var(--color-terracotta)] transition-colors hover:text-[var(--color-gentle-gold)]"
    >
      Mehr im Verzeichnis
    </a>
  </div>

  <div class="mt-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
    {salons.map((salon) => (
      <article class="rounded-[var(--radius-lg)] border border-[var(--color-light-taupe)] bg-white shadow-[var(--shadow-sm)] hover:shadow-[var(--shadow-md)] transition overflow-hidden">
        <a
          href={`/salon/${salon.slug}`}
          class="block"
          aria-label={`${salon.salon_name ?? "Salon"}${salon.category_name ? ` - ${salon.category_name}` : ""}${salon.city_name ? ` in ${salon.city_name}` : ""}`}
        >
          <SalonImage
            coverImage={salon.cover_image}
            alt={salon.salon_name ?? "Salon"}
            class="h-44 w-full object-cover"
          />

          <div class="p-5">
            <h3 class="text-base font-semibold text-slate-900">
              {salon.salon_name ?? "Salon"}
              <span class="block mt-1 text-sm font-medium text-[var(--color-medium-gray)]">
                {salon.category_name ?? "Beauty & Wellness"}
                {salon.city_name ? ` in ${salon.city_name}` : " in Deutschland"}
              </span>
            </h3>
            {salon.full_address && (
              <p class="mt-1 text-sm text-slate-600 line-clamp-2">
                {salon.full_address}
              </p>
            )}

            <div class="mt-3 flex items-center justify-between text-sm text-slate-600">
              <span class="font-semibold text-[var(--color-gentle-gold)]">
                &#11088; {salon.rating_value ?? "Neu"}
              </span>
              <span class="text-slate-500">
                ({salon.rating_count ?? 0})
              </span>
            </div>
          </div>
        </a>
      </article>
    ))}
  </div>
</section>

