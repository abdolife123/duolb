---
// Navbar.astro
---

<header class="sticky top-0 z-50 border-b border-[var(--color-light-taupe)] bg-[var(--color-soft-white)] shadow-[var(--shadow-sm)]">
  <div class="max-w-7xl mx-auto">
    <div class="h-[72px] flex items-center justify-between">
      <a href="/" class="flex items-center gap-4 group shrink-0">
        <div class="relative flex items-center justify-center">
          <svg width="42" height="42" viewBox="0 0 100 100">
            <path
              d="M30 10 V90 H55 C75 90 90 75 90 50 C90 25 75 10 55 10 H30 Z"
              stroke="var(--color-gentle-gold)"
              stroke-width="3"
              fill="none"></path>
          </svg>
          <div class="absolute h-1.5 w-1.5 rounded-full bg-[var(--color-gentle-gold)]"></div>
        </div>
        <div class="flex flex-col">
          <span
            class="text-3xl font-serif leading-none tracking-[0.04em] text-gray-900"
            >duolb</span
          >
          <span
            class="text-[9px] font-semibold uppercase tracking-[0.3em] text-gray-400"
            >Beauty Starts with Confidence</span
          >
        </div>
      </a>

      <nav class="hidden lg:flex items-center gap-12">
        <a
          href="/"
          class="nav-link text-[13px] font-medium uppercase tracking-[0.2em] text-gray-600 hover:text-[var(--color-gentle-gold)]"
          >Startseite</a
        >
        <a
          href="/directory"
          class="nav-link text-[13px] font-medium uppercase tracking-[0.2em] text-gray-600 hover:text-[var(--color-gentle-gold)]"
          >Verzeichnis</a
        >
        <a
          href="/near-you"
          class="nav-link text-[13px] font-medium uppercase tracking-[0.2em] text-gray-600 hover:text-[var(--color-gentle-gold)]"
          >In der Nähe</a
        >
        <a
          href="/posts"
          class="nav-link text-[13px] font-medium uppercase tracking-[0.2em] text-gray-600 hover:text-[var(--color-gentle-gold)]"
          >Blog</a
        >
      </nav>
<div class="flex items-center gap-6">
  <button
    id="searchToggle"
    type="button"
    aria-label="Open search"
    aria-controls="site-search"
    aria-expanded="false"
    class="text-gray-400 hover:text-[var(--color-gentle-gold)] transition-colors p-2 focus:outline-none"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="22"
      height="22"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      aria-hidden="true"
      focusable="false"
    >
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
  </button>

  <a
    href="/contact"
    class="hidden lg:inline-block rounded-full bg-[#D8A7B1] px-8 py-3.5 text-[12px] font-semibold uppercase tracking-[0.2em] text-[#FBF6F2] shadow-md shadow-[#D8A7B1]/30 hover:-translate-y-0.5 hover:bg-[#9CAF9A] hover:shadow-lg hover:shadow-[#9CAF9A]/30 transition-all"
  >
    <span class="text-[#FBF6F2]">Kontakt</span>
  </a>
</div>

    </div>
  </div>

  <div
    id="searchContainer"
    class="max-h-0 overflow-hidden border-t border-[var(--color-light-taupe)] bg-[var(--color-warm-cream)] transition-all duration-500 ease-in-out"
  >
    <div class="max-w-7xl mx-auto py-8">
      <form action="/search" method="GET" class="relative">
        <input
          type="text"
          name="q"
          id="searchInput"
          placeholder="Wonach suchen Sie heute?"
          class="w-full bg-transparent text-3xl md:text-4xl font-serif text-gray-900 border-none outline-none placeholder:text-gray-200"
        />
        <p class="text-[10px] uppercase tracking-widest text-gray-400 mt-4">
          Drücken Sie Enter zum Suchen
        </p>
      </form>
    </div>
  </div>
</header>

<style>
  header {
    color: var(--color-deep-slate);
    transition: box-shadow var(--transition-base), background-color var(--transition-base);
  }

  /* Match design system typography without changing markup structure. */
  header .text-3xl.font-serif {
    font-family: var(--font-accent);
  }

  header .nav-link {
    font-family: var(--font-body);
    color: var(--color-charcoal);
    border-bottom: 2px solid transparent;
    padding-bottom: 4px;
    transition: color var(--transition-base), border-color var(--transition-base);
  }

  /* Disable global underline animation for .nav-link in the header. */
  header .nav-link::after {
    content: none !important;
  }

  header .nav-link:hover {
    color: var(--color-gentle-gold);
  }

  /* If an active class or aria-current is applied elsewhere, render it per design system. */
  header .nav-link.active,
  header .nav-link[aria-current="page"] {
    color: var(--color-terracotta);
    border-bottom-color: var(--color-terracotta);
  }
</style>

<script is:inline>
  const initSearch = () => {
    const btn = document.getElementById("searchToggle");
    const container = document.getElementById("searchContainer");
    const input = document.getElementById("searchInput");

    if (!btn || !container) return;

    btn.addEventListener("click", () => {
      const isHidden =
        container.style.maxHeight === "0px" || !container.style.maxHeight;

      if (isHidden) {
        container.style.maxHeight = "200px";
        setTimeout(() => input?.focus(), 300); // Focus after animation
      } else {
        container.style.maxHeight = "0px";
      }
    });

    // Close on Escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") container.style.maxHeight = "0px";
    });
  };

  initSearch();
  // For Astro View Transitions
  document.addEventListener("astro:after-swap", initSearch);
</script>



